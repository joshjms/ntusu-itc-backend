# Index Swapper Documentation

The Swagger's automatic documentation can be used to try some of the features below! Click [here](http://localhost:8888/swagger/) and scroll down to 'starswar' to view and try the Swagger docs.

## Course Index

Fields:

- **code** (max length 6): course code (for example: MH1101)
- **name** (max length 100): course name (for example: CALCULUS II)
- **index** (max length 5, unique): course index (for example: 70145), all indexes are considered unique including those from different modules
- **datetime_added** (auto now): used for internal purpose to know when the course index is created to the database (so we can differentiate the outdated indexes and updated ones)
- **information** (text field): stores collections of (type, group, day, time, venue, remark) details for a course index using '^' as column delimiter and ';' as row delimiter (for example: LEC/STUDIO^LE^THU^0930-1120^LT19A^;LEC/STUDIO^LE^TUE^1330-1420^LT23^;TUT^T1^WED^0830-09.20^SPMS-TR+3^Teaching Wk2-13)
- **pending_count** (integer, default 0): the number of swap requests that has this course index as a foreign key in *current index* field, not to be updated manually; iterating through the related models takes too long, so it is instead stored here and updated for every swap request created/deleted/finished

### `[GET] /starswar/modules/`

Expected to be used in 'all modules' page. Returns all modules through a partial serializer that only displays id, code, course name, course index, pending count. Sample output:

    [
      {
        "id": 1,
        "code": "MH1101",
        "name": "CALCULUS II",
        "index": "70145",
        "pending_count": 1
      },
      {
        "id": 2,
        "code": "MH1101",
        "name": "CALCULUS II",
        "index": "70146",
        "pending_count": 0
      },
      {
       "id": 3,
        "code": "MH1101",
        "name": "CALCULUS II",
        "index": "70147",
        "pending_count": 2
      },
      {
        "id": 4,
        "code": "MH1201",
        "name": "LINEAR ALGEBRA II",
        "index": "70161",
        "pending_count": 0
      },
      ...
    ]

### `[GET] /starswar/modules/<str:course_index>/`

Expected to be used in 'all modules' or 'my swap requests' page if the user wishes to view more details about an index. Compared to the API above, this API works for specific course index, and additionally send datetime_added, information (list of type-group-day-time-venue-remark), pending count details (indexes of people who want to swap with this index). Sample output:

    TODO

### `[GET] /starswar/modules/get_courses/`

Expected to be used in 'new swap request' page. Fetch all unique course codes and its name. Sample output:

    [
      {
        "code": "MH1101",
        "name": "CALCULUS II"
      },
      {
        "code": "MH1201",
        "name": "LINEAR ALGEBRA II"
      },
      {
        "code": "MH1301",
        "name": "DISCRETE MATHEMATICS"
      }
    ]

### `[GET] /starswar/modules/get_indexes/<str:course_code>/`

Expected to be used in 'new swap request' page after a user selects a course code. Return a list of all available indexes along with information and pending count, given a course code. Sample output:

    [
      {
        "index": "70145",
        "pending_count": 0,
        "information": [
          {
            "type": "LEC/STUDIO",
            "group": "LE",
            "day": "THU",
            "time": "0930-1120",
            "venue": "LT19A",
            "remark": ""
          },
          {
            "type": "LEC/STUDIO",
            "group": "LE",
            "day": "TUE",
            "time": "1330-1420",
            "venue": "LT23",
            "remark": ""
          },
          {
            "type": "TUT",
            "group": "T1",
            "day": "WED",
            "time": "0830-09.20",
            "venue": "SPMS-TR+3",
            "remark": "Teaching Wk2-13"
          }
        ]
      },
      ...
    ]

### `[PUT/PATCH/DELETE] /starswar/modules/<str:course_index>/`

These APIs are generated by the DRF viewsets, which might be useful for admin actions of manually adding / editing / deleting modules from the database. Alternatively, the admins can do it right away through Django's admin page. For now, these APIs might not be needed first, but in the future we can create admin pages to edit the modules and these API can be used later on. Current implementations only allow SuperUser to access these APIs (as per default, uses JWT header authentication).

### `[POST] /starswar/modules/populate_db/`

Uses web scraper to automatically populate database using an async function. Requires super user, not intended to be called anywhere in the frontend. Be really careful when calling this API.

## Swap Request

TODO

### TODO

TODO - description

### TODO

TODO - description

### TODO

TODO - description

### TODO

TODO - description